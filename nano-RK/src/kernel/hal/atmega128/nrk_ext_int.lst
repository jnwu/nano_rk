   1               		.file	"nrk_ext_int.c"
   2               	__SREG__ = 0x3f
   3               	__SP_H__ = 0x3e
   4               	__SP_L__ = 0x3d
   5               	__CCP__  = 0x34
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  12               		.text
  13               	.Ltext0:
 121               	.global	nrk_ext_int_enable
 123               	nrk_ext_int_enable:
 124               		.stabd	46,0,0
   0:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** /******************************************************************************
   1:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  Nano-RK, a real-time operating system for sensor networks.
   2:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  Copyright (C) 2007, Real-Time and Multimedia Lab, Carnegie Mellon University
   3:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  All rights reserved.
   4:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *
   5:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  This is the Open Source Version of Nano-RK included as part of a Dual
   6:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  Licensing Model. If you are unsure which license to use please refer to:
   7:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  http://www.nanork.org/nano-RK/wiki/Licensing
   8:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *
   9:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  This program is free software: you can redistribute it and/or modify
  10:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  it under the terms of the GNU General Public License as published by
  11:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  the Free Software Foundation, version 2.0 of the License.
  12:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *
  13:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  This program is distributed in the hope that it will be useful,
  14:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  but WITHOUT ANY WARRANTY; without even the implied warranty of
  15:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  16:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  GNU General Public License for more details.
  17:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *
  18:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  You should have received a copy of the GNU General Public License
  19:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  20:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *
  21:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  Contributing Authors (specific to this file):
  22:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *  Anthony Rowe
  23:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** *******************************************************************************/
  24:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 
  25:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** #include <include.h>
  26:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** #include <avr/interrupt.h>
  27:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** #include <ulib.h>
  28:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** #include <nrk_ext_int.h>
  29:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** #include <nrk_error.h>
  30:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** #include <nrk_cfg.h>
  31:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 
  32:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 
  33:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** int8_t  nrk_ext_int_enable(uint8_t pin )
  34:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** {
 126               	.LM0:
 127               	.LFBB1:
 128               	/* prologue: function */
 129               	/* frame size = 0 */
  35:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** //if(pin==NRK_EXT_INT_0) { EIMSK |= 1; return NRK_OK; }
  36:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** return NRK_ERROR;
  37:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** }
 131               	.LM1:
 132 0000 8FEF      		ldi r24,lo8(-1)
 133               	/* epilogue start */
 134 0002 0895      		ret
 136               	.Lscope1:
 138               		.stabd	78,0,0
 141               	.global	nrk_ext_int_disable
 143               	nrk_ext_int_disable:
 144               		.stabd	46,0,0
  38:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 
  39:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** int8_t  nrk_ext_int_disable(uint8_t pin )
  40:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** {
 146               	.LM2:
 147               	.LFBB2:
 148               	/* prologue: function */
 149               	/* frame size = 0 */
  41:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** //if(pin==NRK_EXT_INT_0) { EIMSK &= ~1; return NRK_OK; }
  42:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** return NRK_ERROR;
  43:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** }
 151               	.LM3:
 152 0004 8FEF      		ldi r24,lo8(-1)
 153               	/* epilogue start */
 154 0006 0895      		ret
 156               	.Lscope2:
 158               		.stabd	78,0,0
 163               	.global	nrk_ext_int_configure
 165               	nrk_ext_int_configure:
 166               		.stabd	46,0,0
  44:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 
  45:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 
  46:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 
  47:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** int8_t  nrk_ext_int_configure(uint8_t pin, uint8_t mode, void *callback_func)
  48:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** {
 168               	.LM4:
 169               	.LFBB3:
 170               	/* prologue: function */
 171               	/* frame size = 0 */
  49:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** /*if(pin==NRK_EXT_INT_0)
  50:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 	{
  51:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 	ext_int0_callback=callback_func;
  52:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 	if(mode==NRK_LOW_TRIGGER) EICRA &= ~(BM(ISC01) | BM(ISC00));
  53:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 	if(mode==NRK_LEVEL_TRIGGER) 
  54:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 		{ EICRA &= (~BM(ISC01)); EICRA |= BM(ISC00); }
  55:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 	if(mode==NRK_FALLING_EDGE) 
  56:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 		{ EICRA |= BM(ISC01); EICRA &= (~BM(ISC00)); }
  57:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 	if(mode==NRK_RISING_EDGE) EICRA |= BM(ISC01) | BM(ISC00);
  58:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 	return NRK_OK;
  59:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 	}
  60:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** */
  61:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** return NRK_ERROR;
  62:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** }
 173               	.LM5:
 174 0008 8FEF      		ldi r24,lo8(-1)
 175               	/* epilogue start */
 176 000a 0895      		ret
 178               	.Lscope3:
 180               		.stabd	78,0,0
 182               	.global	__vector_1
 184               	__vector_1:
 185               		.stabd	46,0,0
  63:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 
  64:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 
  65:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 
  66:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** SIGNAL(INT0_vect) {
 187               	.LM6:
 188               	.LFBB4:
 189 000c 1F92      		push __zero_reg__
 190 000e 0F92      		push r0
 191 0010 0FB6      		in r0,__SREG__
 192 0012 0F92      		push r0
 193 0014 0BB6      		in r0,91-32
 194 0016 0F92      		push r0
 195 0018 1124      		clr __zero_reg__
 196 001a 2F93      		push r18
 197 001c 3F93      		push r19
 198 001e 4F93      		push r20
 199 0020 5F93      		push r21
 200 0022 6F93      		push r22
 201 0024 7F93      		push r23
 202 0026 8F93      		push r24
 203 0028 9F93      		push r25
 204 002a AF93      		push r26
 205 002c BF93      		push r27
 206 002e EF93      		push r30
 207 0030 FF93      		push r31
 208               	/* prologue: Signal */
 209               	/* frame size = 0 */
  67:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** //	if(ext_int0_callback!=NULL) ext_int0_callback();
  68:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** //	else
  69:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 	nrk_kernel_error_add(NRK_SEG_FAULT,0);
 211               	.LM7:
 212 0032 8AE0      		ldi r24,lo8(10)
 213 0034 60E0      		ldi r22,lo8(0)
 214 0036 0E94 0000 		call nrk_kernel_error_add
 215               	/* epilogue start */
  70:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** 	return;  	
  71:../../../src/kernel/hal/atmega128/nrk_ext_int.c **** }
 217               	.LM8:
 218 003a FF91      		pop r31
 219 003c EF91      		pop r30
 220 003e BF91      		pop r27
 221 0040 AF91      		pop r26
 222 0042 9F91      		pop r25
 223 0044 8F91      		pop r24
 224 0046 7F91      		pop r23
 225 0048 6F91      		pop r22
 226 004a 5F91      		pop r21
 227 004c 4F91      		pop r20
 228 004e 3F91      		pop r19
 229 0050 2F91      		pop r18
 230 0052 0F90      		pop r0
 231 0054 0BBE      		out 91-32,r0
 232 0056 0F90      		pop r0
 233 0058 0FBE      		out __SREG__,r0
 234 005a 0F90      		pop r0
 235 005c 1F90      		pop __zero_reg__
 236 005e 1895      		reti
 238               	.Lscope4:
 240               		.stabd	78,0,0
 241               		.comm _nrk_signal_list,4,1
 242               		.comm ext_int0_callback,2,1
 243               		.comm ext_int1_callback,2,1
 244               		.comm ext_int2_callback,2,1
 245               		.comm pc_int0_callback,2,1
 246               		.comm error_task,1,1
 247               		.comm error_num,1,1
 256               	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 nrk_ext_int.c
     /tmp/ccUoqrNT.s:2      *ABS*:0000003f __SREG__
     /tmp/ccUoqrNT.s:3      *ABS*:0000003e __SP_H__
     /tmp/ccUoqrNT.s:4      *ABS*:0000003d __SP_L__
     /tmp/ccUoqrNT.s:5      *ABS*:00000034 __CCP__
     /tmp/ccUoqrNT.s:6      *ABS*:00000000 __tmp_reg__
     /tmp/ccUoqrNT.s:7      *ABS*:00000001 __zero_reg__
     /tmp/ccUoqrNT.s:123    .text:00000000 nrk_ext_int_enable
     /tmp/ccUoqrNT.s:143    .text:00000004 nrk_ext_int_disable
     /tmp/ccUoqrNT.s:165    .text:00000008 nrk_ext_int_configure
     /tmp/ccUoqrNT.s:184    .text:0000000c __vector_1
                            *COM*:00000004 _nrk_signal_list
                            *COM*:00000002 ext_int0_callback
                            *COM*:00000002 ext_int1_callback
                            *COM*:00000002 ext_int2_callback
                            *COM*:00000002 pc_int0_callback
                            *COM*:00000001 error_task
                            *COM*:00000001 error_num

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
nrk_kernel_error_add
